B = [1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
1	1	1	1	0	0	0	0	0	0	0	0	0	0	0	0;
1	0	0	0	1	1	1	0	0	0	0	0	0	0	0	0;
1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1;
0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
0	1	2	3	0	0	0	0	0	0	0	0	0	0	0	0;
0	1	0	0	0	0	0	1	0	0	1	0	0	1	0	0;
0	1	2	3	0	0	0	1	2	3	1	2	3	1	2	3;
0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0;
0	0	0	0	1	0	0	1	1	1	0	0	0	0	0	0;
0	0	0	0	1	2	3	0	0	0	0	0	0	0	0	0;
0	0	0	0	1	2	3	1	1	1	2	2	2	3	3	3;
0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0;
0	0	0	0	0	0	0	1	2	3	0	0	0	0	0	0;
0	0	0	0	0	0	0	1	0	0	2	0	0	3	0	0;
0	0	0	0	0	0	0	1	2	3	2	4	6	3	6	9]
[lu, pvt, lupivoted] = LUfactor(B);

syms x y;
f=exp(-(x^2+y^2));
fx = diff(f,x);
fy = diff(f,y);
fxy = diff(fx,y);
t = [0 0; 1 0; 0 1; 1 1];
s = zeros(16,1);
for i=1:4
   s(i) = subs(f, [x,y], [t(i, 1), t(i, 2)]); 
end
for i=1:4
   s(i+4) = subs(fx, [x,y], [t(i, 1), t(i, 2)]); 
end
for i=1:4
   s(i+8) = subs(fy, [x,y], [t(i, 1), t(i, 2)]); 
end
for i=1:4
   s(i+12) = subs(fxy, [x,y], [t(i, 1), t(i, 2)]); 
end
alpha = LUsolve(lu, s, pvt);